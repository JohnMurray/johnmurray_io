<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SSH FS Script</title>
  <meta name="description" content="Due to my employer’s server-configuration, I find myself developingon remote machines often. However, I find it a pain to setup a devenvironment on every new...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.johnmurray.io/2013/07/15/SSH-FS-Script.html">
  <link rel="alternate" type="application/rss+xml" title="John Murray" href="http://www.johnmurray.io/feed.xml" />
</head>


  <body>

    <header class="masthead">
  <div class="masthead-inner">
    <a href="/"><h1>murray</h2></a>
    <p class="sub">
      <a href="http://github.com/johnmurray">github</a>
      |
      <a href="http://twitter.com/johnmurray_io">twitter</a>
      |
      <a href="http://linkedin.com/pub/john-murray/22/a86/80a/en">linkedin</a>
    </p>
    <p class="sub">&copy; 2015. All Rights Reserved</p>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">SSH FS Script</h1>
    <p class="post-meta">Jul 15, 2013</p>
  </header>

  <article class="post-content">
    <p>Due to my employer’s server-configuration, I find myself developing
on remote machines often. However, I find it a pain to setup a dev
environment on every new machine. So, I usually just end up working
local as much as possible via SSH-FS. For anyone else that had to
do this as well, here is a handly little script that will hopefully
help you out (just a little).</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="c">#!/usr/bin/env python</span>
<span class="lineno"> 2</span> <span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">call</span>
<span class="lineno"> 3</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="lineno"> 4</span>  
<span class="lineno"> 5</span> <span class="n">servers</span> <span class="o">=</span> <span class="p">[</span>
<span class="lineno"> 6</span>   <span class="p">{</span>
<span class="lineno"> 7</span>     <span class="s">&#39;host&#39;</span><span class="p">:</span> <span class="s">&#39;some.remote.host&#39;</span><span class="p">,</span>          <span class="c"># host to connect to</span>
<span class="lineno"> 8</span>     <span class="s">&#39;dir&#39;</span> <span class="p">:</span> <span class="s">&#39;/usr/local/supersecret/&#39;</span>    <span class="c"># remote dir to mount</span>
<span class="lineno"> 9</span>   <span class="p">},</span>
<span class="lineno">10</span>   <span class="p">{</span>
<span class="lineno">11</span>     <span class="s">&#39;host&#39;</span><span class="p">:</span> <span class="s">&#39;some.other.remote.host&#39;</span><span class="p">,</span>
<span class="lineno">12</span>     <span class="s">&#39;dir&#39;</span> <span class="p">:</span> <span class="s">&#39;/home/USER/&#39;</span>
<span class="lineno">13</span>   <span class="p">}</span>
<span class="lineno">14</span> <span class="p">]</span>
<span class="lineno">15</span> <span class="n">user</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;USER&#39;</span><span class="p">]</span>
<span class="lineno">16</span>  
<span class="lineno">17</span>  
<span class="lineno">18</span> <span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
<span class="lineno">19</span>   <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">20</span> <span class="sd">  Connect SSH-FS&#39;s</span>
<span class="lineno">21</span> <span class="sd">  &quot;&quot;&quot;</span>
<span class="lineno">22</span>   <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">servers</span><span class="p">:</span>
<span class="lineno">23</span>     <span class="k">try</span><span class="p">:</span>
<span class="lineno">24</span>       <span class="k">print</span><span class="p">(</span><span class="s">&quot;connecting to </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;host&#39;</span><span class="p">]))</span>
<span class="lineno">25</span>       <span class="k">print</span><span class="p">(</span><span class="s">&quot;------------------------------&quot;</span><span class="p">)</span>
<span class="lineno">26</span>       <span class="n">call</span><span class="p">([</span><span class="s">&quot;sudo&quot;</span><span class="p">,</span> <span class="s">&quot;mkdir&quot;</span><span class="p">,</span> <span class="s">&quot;-p&quot;</span><span class="p">,</span> <span class="s">&quot;/Volumes/</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;host&#39;</span><span class="p">])])</span>
<span class="lineno">27</span>       <span class="n">call</span><span class="p">([</span><span class="s">&quot;sudo&quot;</span><span class="p">,</span> <span class="s">&quot;chown&quot;</span><span class="p">,</span> <span class="s">&quot;-R&quot;</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="s">&quot;/Volumes/</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;host&#39;</span><span class="p">])])</span>
<span class="lineno">28</span>       <span class="n">status</span> <span class="o">=</span> <span class="n">call</span><span class="p">([</span><span class="s">&quot;sshfs&quot;</span><span class="p">,</span>
<span class="lineno">29</span>                      <span class="s">&quot;</span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;host&#39;</span><span class="p">],</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;dir&#39;</span><span class="p">]),</span>
<span class="lineno">30</span>                      <span class="s">&quot;/Volumes/</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;host&#39;</span><span class="p">])])</span>
<span class="lineno">31</span>  
<span class="lineno">32</span>       <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="lineno">33</span>         <span class="k">print</span><span class="p">(</span><span class="s">&quot;connected&quot;</span><span class="p">)</span>
<span class="lineno">34</span>         <span class="k">print</span><span class="p">(</span><span class="s">&quot;mounted locally at /Volumes/</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;host&#39;</span><span class="p">]))</span>
<span class="lineno">35</span>         <span class="k">print</span><span class="p">(</span><span class="s">&quot;mounted remotely at </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">server</span><span class="p">[</span><span class="s">&#39;dir&#39;</span><span class="p">]))</span>
<span class="lineno">36</span>     <span class="k">except</span><span class="p">:</span>
<span class="lineno">37</span>       <span class="k">print</span> <span class="s">&quot;Unexpected error:&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="lineno">38</span>     <span class="k">finally</span><span class="p">:</span>
<span class="lineno">39</span>       <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="lineno">40</span>  
<span class="lineno">41</span>  
<span class="lineno">42</span> <span class="k">def</span> <span class="nf">get_sudo</span><span class="p">():</span>
<span class="lineno">43</span>   <span class="n">call</span><span class="p">([</span><span class="s">&quot;echo&quot;</span><span class="p">,</span> <span class="s">&quot;Running as root. Beware!! (mwahahahaha)&quot;</span><span class="p">])</span>
<span class="lineno">44</span>   <span class="n">call</span><span class="p">([</span><span class="s">&quot;sudo&quot;</span><span class="p">,</span> <span class="s">&quot;echo&quot;</span><span class="p">])</span>
<span class="lineno">45</span>  
<span class="lineno">46</span>  
<span class="lineno">47</span> <span class="n">get_sudo</span><span class="p">()</span>
<span class="lineno">48</span> <span class="n">connect</span><span class="p">()</span></code></pre></div>


  </article>

</div>

      </div>
    </div>


    <!-- Google Analytics -->
    <script type="application/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-11511983-4']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); 
        ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>

</html>
